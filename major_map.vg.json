{
    "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
   	"title": { "text": "Major storms, 1980 to 2025" },
    "projection" : {"type" : "equirectangular"},

    "width": 500,
    "height": 400,
    "view": {"fill": "lightblue"},

    "params" : [
    {
        "name" : "whichType",
        "value" : "hail",
        "bind" : {
            "input" : "select",
            "options" : ["hail", "lightning", "rain", "wind"],
            "name" : "Select storm type: ",
            "labels" :  ["Hail", "Lightning", "Rain", "Wind"]
        }
    }
    ],

    "layer" : [ 
        {
            "data" : {
                "url" : "data/ne_50m_state+grid_AUS.json",
                "format" : {"type" : "topojson", "feature" :"ne_50m_graticules_10" }            
            },
            "mark" : {"type" : "geoshape", "fill" : null, "stroke": "grey"}
        },
        {
            "data" : {
                "url" : "data/ne_50m_state+grid_AUS.json",
                "format" : {"type" : "topojson", "feature" :"ne_50m_admin_1_states_provinces" }            
            },
            "mark" : {"type" : "geoshape", "fill" : "lightgray", "stroke": "black"}            
        },
        {
            "data" : {
                "url" : "data/Inj ALL 80-25.csv"
            },

           "transform" : [
                {
                    "filter" : { "field" :"TYPE2", "equal" : {"expr" :"whichType"}} 
                }
            ],

            "mark" : "circle",

            "encoding" : {
                "longitude" : {"field" : "Longitude", "type" :"quantitative"},
                "latitude" : {"field" : "Latitude", "type" :"quantitative"},
                "size" : {"field" : "Number of injuries", "type" :"quantitative",
                    "scale" : {
                        "type" : "threshold",
                        "domain" : [2, 5, 10, 20],
                        "range" : [40, 80, 160, 320, 640]    
                    },
                    "legend" : {
                        "orient" : "bottom"
                    }
                },
                "color" : {"field" : "Number of deaths", "type" : "ordinal",
                    "scale" : { 
                        "range" : ["#2c7bb6","#ffff00", "#d7191c"]
                    },
                    "legend" : {
                        "orient" : "bottom"
                    }
                },
                
                "opacity" : {"value" : 0.6},
                
                "tooltip" : [
                    {"field" : "TYPE2", "title" : "Storm type"},
                    {"field" : "Year", "type" :"ordinal"},
                    {"field" : "State", "type" :"nominal"}, 

                    {"field" : "Number of injuries", "type" :"quantitative"},
                    {"field" : "Number of deaths", "type" :"quantitative"},
  
                    {"field" : "Feature", "type" :"nominal"},
                    {"field" : "Measure", "type" :"quantitative"}

                ]

            }
        }        

    ]
}        