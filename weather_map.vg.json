{
    "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
   	"title": { "text": "Average weather at major cities, 1980 to 2010" },
    "projection" : {"type" : "equirectangular"},

    "width": 450,
    "height": 300,

    "params" : [
    {
        "name" : "whichType",
        "value" : "Monthly rain (mm)",
        "bind" : {
            "input" : "select",
            "options" : ["Temp max (C)","Temp min (C)", "Monthly rain (mm)"],
            "name" : "Select weather: "
        }
    }
    ],

    "layer" : [ 
        {
            "data" : {
                "url" : "data/ne_50m_state+grid_AUS.json",
                "format" : {"type" : "topojson", "feature" :"ne_50m_admin_1_states_provinces" }            
            },
            "mark" : {"type" : "geoshape", "fill" : "gray", "stroke": "black"}
        },
        {
            "data" : {
                "url" : "data/ne_50m_state+grid_AUS.json",
                "format" : {"type" : "topojson", "feature" :"ne_50m_graticules_10" }            
            },
            "mark" : {"type" : "geoshape", "fill" : null, "stroke": "lightgray"}
        },
        {
            "data" : {
                "url" : "data/Weather SLIM.csv"
            },

            "transform" : [
                {
                    "filter" : { "field" :"Weather", "equal" : {"expr" :"whichType"}} 
                }
            ],

            "mark" : "circle",

            "encoding" : {             
                "latitude" : {"field" : "Latitude", "type": "quantitative"},
                "longitude" : {"field" : "Longitude", "type": "quantitative"},

                "color" : {
                    "field" : "Extreme value", "type" :"quantitative",                    
                    "scale" : {
                        "type" : "quantize",
                        "nice" : 4
                    },
                    "legend" : {
                        "title" : {"signal" : "whichType"}
                    }
                },

                "size" : {"value" : 2000},

                "tooltip" : [
                    {"field" : "LOCATION", "type": "nominal", "title" : "City name"},
                    {"field" : "Weather", "type" : "nominal"},
                    {"field" : "Extreme value", "type" : "quantitative"}
                ]
            }
        }        

    ]
}        