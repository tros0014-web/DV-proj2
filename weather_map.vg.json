{
    "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
   	"title": { "text": "Weather extremes, 1980 to 2010" },
    "projection" : {"type" : "equirectangular"},

    "width": 500,
    "height": 400,
    "view": {"fill": "lightblue"},

    "params" : [
    {
        "name" : "whichType",
        "value" : "darkblue  Monthly rain (mm)",
        "bind" : {
            "input" : "select",
            "options" : ["darkred  Temp max (C)","darkblue  Temp min (C)", 
            "darkblue  Monthly rain (mm)" ],
            "name" : "Select weather: ",
            "labels" : ["Temp max (C)","Temp min (C)", "Monthly rain (mm)"]
        }
    }
    ],

    "layer" : [ 
        {
            "data" : {
                "url" : "data/ne_50m_state+grid_AUS.json",
                "format" : {"type" : "topojson", "feature" :"ne_50m_graticules_10" }            
            },
            "mark" : {"type" : "geoshape", "fill" : null, "stroke": "grey"}
        },
        {
            "data" : {
                "url" : "data/ne_50m_state+grid_AUS.json",
                "format" : {"type" : "topojson", "feature" :"ne_50m_admin_1_states_provinces" }            
            },
            "mark" : {"type" : "geoshape", "fill" : "lightgray", "stroke": "black"}
        },
        {
            "data" : {
                "url" : "data/Weather SLIM.csv"
            },

            "transform" : [
                {
                    "filter" : { "field" :"Weather", "equal" : {"expr" : "split(whichType,'  ')[1]"}} 
                }
            ],

            "mark" : "circle",

            "encoding" : {             
                "latitude" : {"field" : "Latitude", "type": "quantitative"},
                "longitude" : {"field" : "Longitude", "type": "quantitative"},

                "color" : {
                    "field" : "Extreme value", "type" :"quantitative",                    
                    "scale" : {
                        "type" : "quantize",
                        "nice" : 4,
                        "scheme" : {"expr" : "split(whichType,'  ')[0]"},
                        "reverse" : true
                    },
                    "legend" : {
                        "title" : {"signal" : "split(whichType,'  ')[1]"},
                        "orient" : "bottom"
                    }                    
                },

                "size" : {"value" : 2000},
                "opacity" : {"value" : 0.9},

                "tooltip" : [
                    {"field" : "LOCATION", "type": "nominal", "title" : "City name"},
                    {"field" : "Weather", "type" : "nominal"},
                    {"field" : "Extreme value", "type" : "quantitative"}
                ]
            }
        },
        {
            "data" : {
                "url" : "data/Weather SLIM.csv"
            },

            "transform" : [
                {
                     "filter" : { "field" :"LOCATION", "equal" : "Alice Springs"} 
                },
                {
                    "filter" : { "field" :"Weather", "equal" : {"expr" : "split(whichType,'  ')[1]"}} 
                }
            ],

            "mark" : {
                "type" : "text",
                "text" : [
                        "Alice Springs has the most",
                        "extreme temperature range", 
                        "from 3.9 C to 36.9 C." ],
                "dx" : -80,
                "dy" : -10
            },

            "encoding" : {             
                "latitude" : {"field" : "Latitude", "type": "quantitative"},
                "longitude" : {"field" : "Longitude", "type": "quantitative"}
            }
        }    

    ]
}        